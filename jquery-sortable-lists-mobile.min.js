!function(e){e.fn.sortableLists=function(l){var s=e("body").css("position","relative"),t={currElClass:"",placeholderClass:"",placeholderCss:{position:"relative",padding:0},hintClass:"",hintCss:{display:"none",position:"relative",padding:0},hintWrapperClass:"",hintWrapperCss:{},baseClass:"",baseCss:{position:"absolute",top:0-parseInt(s.css("margin-top")),left:0-parseInt(s.css("margin-left")),margin:0,padding:0,"z-index":2500},opener:{active:!1,open:"",close:"",openerCss:{float:"left",display:"inline-block","background-position":"center center","background-repeat":"no-repeat"},openerClass:""},maxLevels:!1,listSelector:"ul",listsClass:"",listsCss:{},insertZone:50,insertZonePlus:!1,scroll:20,ignoreClass:"",isAllowed:function(e,l,s){return!0},onDragStart:function(e,l){return!0},onChange:function(e){return!0},complete:function(e){return!0}},o=e.extend(!0,{},t,l),n=e("<"+o.listSelector+" />").prependTo(s).attr("id","s-l-base").css(o.baseCss).addClass(o.listsClass+" "+o.baseClass),r=e("<li />").attr("id","s-l-placeholder").css(o.placeholderCss).addClass(o.placeholderClass),i=e("<li />").attr("id","s-l-hint").css(o.hintCss).addClass(o.hintClass),a=e("<"+o.listSelector+" />").attr("id","s-l-hint-wrapper").addClass(o.listsClass+" "+o.hintWrapperClass).css(o.listsCss).css(o.hintWrapperCss),c=e("<span />").addClass("s-l-opener "+o.opener.openerClass).css(o.opener.openerCss).on("mousedown touchstart",function(l){var s=e(this).closest("li");return s.hasClass("s-l-closed")?w(s):b(s),!1});"class"==o.opener.as?c.addClass(o.opener.close):"html"==o.opener.as?c.html(o.opener.close):console.error("jQuerySortableLists opener as background image has been removed with release 2.0.0. Use html instead please.");var p={isDragged:!1,isRelEFP:null,oEl:null,rootEl:{el:e(this),offset:null,rootElClass:e(this).attr("class")},cEl:null,placeholderParentLi:null,upScroll:!1,downScroll:!1,pX:0,pY:0,cX:0,cY:0,isAllowed:!0,e:{pageX:0,pageY:0,clientX:0,clientY:0},scrollAncestors:[],scrollingEl:e(document.scrollingElement||document.documentElement),doc:e(document),win:e(window)};if(o.opener.active){if(!o.opener.open)throw"Opener.open value is not defined. It should be valid url, html or css class.";if(!o.opener.close)throw"Opener.close value is not defined. It should be valid url, html or css class.";var d=null;e(this).find("li").each(function(){(d=e(this)).children(o.listSelector).length&&(c.clone(!0).prependTo(d.children("div").first()),d.hasClass("s-l-open")?w(d):b(d))})}return this.on("mousedown touchstart",function(l){var s=e(l.target);if(!(!1!==p.isDragged||o.ignoreClass&&s.hasClass(o.ignoreClass))){l.preventDefault(),"touchstart"===l.type&&v(l);var t=s.closest("li"),a=e(this);t[0]&&(o.onDragStart(l,t),function(l,s,t){p.isDragged=!0;var a=parseInt(s.css("margin-top")),c=parseInt(s.css("margin-bottom")),d=parseInt(s.css("margin-left")),u=parseInt(s.css("margin-right")),g=s.offset(),v=s.innerHeight();p.rootEl={el:t,offset:t.offset(),rootElClass:t.attr("class")},p.scrollAncestors=e(t.parents(":not(html, body)").filter(function(){return e(this).get(0).scrollHeight>e(this).get(0).clientHeight}).get()),p.cEl={el:s,mT:a,mL:d,mB:c,mR:u,offset:g,insideLevels:S(s)},p.cEl.xyOffsetDiff={X:l.pageX-p.cEl.offset.left,Y:l.pageY-p.cEl.offset.top},p.cEl.el.addClass("s-l-current "+o.currElClass),s.before(r);var m=p.placeholderNode=e("#s-l-placeholder");s.css({width:s.width(),position:"absolute",top:g.top-a,left:g.left-d}).prependTo(n),m.css({display:"block",height:v}),i.css("height",v),p.doc.on("mousemove touchmove",h).on("mouseup touchend touchcancel",f)}(l,t,a))}});function h(l){if(p.isDragged){var s=p.rootEl.el,t=(p.rootEl.offset,p.scrollAncestors),n=p.scrollingEl,r=p.cEl,i=(p.doc,p.win);"touchmove"===l.type&&v(l),l.pageX||function(e){e.pageY=p.pY,e.pageX=p.pX,e.clientY=p.cY,e.clientX=p.cX}(l);var a=s.offset().top+parseInt(s.css("margin-top")),c=s.offset().top+parseInt(s.css("margin-top"))+s.outerHeight(!1),d=t.filter(function(){var s=e(this).offset().top+parseInt(e(this).css("margin-top")),t=s>a;return a=s>a?s:a,l.pageY-a<50&&t}),h=t.filter(function(){var s=e(this).offset().top+parseInt(e(this).css("margin-top"))+e(this).outerHeight(!1),t=s<c;return(c=s<c?s:c)-l.pageY<50&&t});l.clientY<50&&n.scrollTop()>a-10&&(d=d.add(n)),i.height()-l.clientY<50&&n.scrollTop()+i.height()<c+10&&(h=h.add(n)),d.length?p.upScroll?(l.pageY=l.pageY-o.scroll,d.each(function(l){e(this).scrollTop(e(this).scrollTop()-o.scroll)}),u(l)):function(e){if(p.upScroll)return;p.upScroll=setInterval(function(){p.doc.trigger("mousemove")},50)}():h.length?p.downScroll?(l.pageY=l.pageY+o.scroll,h.each(function(l){e(this).scrollTop(e(this).scrollTop()+o.scroll)}),u(l)):function(e){if(p.downScroll)return;p.downScroll=setInterval(function(){p.doc.trigger("mousemove")},50)}():g(p),p.oElOld=p.oEl,r.el[0].style.visibility="hidden",p.oEl=oEl=function(l,s){if(!document.elementFromPoint)return null;var t=p.isRelEFP;if(null===t){var o,n;(o=p.doc.scrollTop())>0&&(t=null==(n=document.elementFromPoint(0,o+e(window).height()-1))||"HTML"==n.tagName.toUpperCase()),(o=p.doc.scrollLeft())>0&&(t=null==(n=document.elementFromPoint(o+e(window).width()-1,0))||"HTML"==n.tagName.toUpperCase())}t&&(l-=p.doc.scrollLeft(),s-=p.doc.scrollTop());var r=e(document.elementFromPoint(l,s));if(!p.rootEl.el.find(r).length)return null;if(r.is("#s-l-placeholder")||r.is("#s-l-hint"))return null;if(!r.is("li"))return(r=r.closest("li"))[0]?r:null;if(r.is("li"))return r}(l.pageX,l.pageY),r.el[0].style.visibility="visible",function(e,l){var s=l.oEl;if(!s||!l.oElOld)return;var t=s.outerHeight(!1),n=e.pageY-s.offset().top;14>n?o.insertZonePlus?C(e,s,7>n):m(e,s):t-14<n&&(o.insertZonePlus?y(e,s,t-7<n):E(e,s))}(l,p),function(e,l){var s=l.cEl;s.el.css({top:e.pageY-s.xyOffsetDiff.Y-s.mT,left:e.pageX-s.xyOffsetDiff.X-s.mL})}(l,p)}}function f(l){var s=p.cEl,t=e("#s-l-hint",p.rootEl.el),n=i[0].style,r=null,a=!1,d=e("#s-l-hint-wrapper");"touchend"!==l.type&&"touchcancel"!==l.type||v(l),"block"==n.display&&t.length&&p.isAllowed?(r=t,a=!0):(r=p.placeholderNode,a=!1),offset=r.offset(),s.el.animate({left:offset.left-p.cEl.mL,top:offset.top-p.cEl.mT},250,function(){!function(e){var l=e.el[0].style;e.el.removeClass(o.currElClass+" s-l-current"),l.top="0",l.left="0",l.position="relative",l.width="auto"}(s),r.after(s.el[0]),r[0].style.display="none",n.display="none",t.remove(),d.removeAttr("id").removeClass(o.hintWrapperClass),d.length&&d.prev("div").append(c.clone(!0)),a?p.placeholderNode.slideUp(150,function(){p.placeholderParentLi=p.placeholderNode.parent().is(p.rootEl.el)?null:p.placeholderNode.parent().closest("li"),p.placeholderNode.remove(),L(),o.onChange(s.el),o.complete(s.el),p.isDragged=!1}):(p.placeholderNode.remove(),L(),o.complete(s.el),p.isDragged=!1)}),g(p),p.doc.unbind("mousemove touchmove",h).unbind("mouseup touchend touchcancel",f)}function u(e){p.pY=e.pageY,p.pX=e.pageX,p.cY=e.clientY,p.cX=e.clientX}function g(e){clearInterval(e.upScroll),clearInterval(e.downScroll),e.upScroll=e.downScroll=!1}function v(e){e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.screenX=e.originalEvent.changedTouches[0].screenX,e.screenY=e.originalEvent.changedTouches[0].screenY}function m(l,s){if(e("#s-l-hint-wrapper",p.rootEl.el).length&&i.unwrap(),l.pageX-s.offset().left<o.insertZone){if(!1!==o.maxLevels&&!Y(!1)||s.prev("#s-l-placeholder").length)return void i.css("display","none");s.before(i)}else{var t=s.children(),n=s.children(o.listSelector).first();if(!1!==o.maxLevels&&!Y(!0)||n.children().first().is("#s-l-placeholder"))return void i.css("display","none");n.length?n.prepend(i):(t.first().after(i),i.wrap(a)),p.oEl&&w(s)}i.css("display","block"),p.isAllowed=o.isAllowed(p.cEl.el,i,i.parents("li").first())}function C(l,s,t){if(e("#s-l-hint-wrapper",p.rootEl.el).length&&i.unwrap(),!t&&l.pageX-s.offset().left>o.insertZone){var n=s.children(),r=s.children(o.listSelector).first();if(!1!==o.maxLevels&&!Y(!0)||r.children().first().is("#s-l-placeholder"))return void i.css("display","none");r.length?r.prepend(i):(n.first().after(i),i.wrap(a)),p.oEl&&w(s)}else{if(!1!==o.maxLevels&&!Y(!1)||s.prev("#s-l-placeholder").length)return void i.css("display","none");s.before(i)}i.css("display","block"),p.isAllowed=o.isAllowed(p.cEl.el,i,i.parents("li").first())}function E(l,s){if(e("#s-l-hint-wrapper",p.rootEl.el).length&&i.unwrap(),l.pageX-s.offset().left<o.insertZone){if(!1!==o.maxLevels&&!Y(!1)||s.next("#s-l-placeholder").length)return void i.css("display","none");s.after(i)}else{var t=s.children(),n=s.children(o.listSelector).last();if(!1!==o.maxLevels&&!Y(!0)||n.children().last().is("#s-l-placeholder"))return void i.css("display","none");n.length?t.last().append(i):(s.append(i),i.wrap(a)),p.oEl&&w(s)}i.css("display","block"),p.isAllowed=o.isAllowed(p.cEl.el,i,i.parents("li").first())}function y(l,s,t){if(e("#s-l-hint-wrapper",p.rootEl.el).length&&i.unwrap(),!t&&l.pageX-s.offset().left>o.insertZone){var n=s.children(),r=s.children(o.listSelector).last();if(!1!==o.maxLevels&&!Y(!0)||r.children().last().is("#s-l-placeholder"))return void i.css("display","none");r.length?n.last().append(i):(s.append(i),i.wrap(a)),p.oEl&&w(s)}else{if(!1!==o.maxLevels&&!Y(!1)||s.next("#s-l-placeholder").length)return void i.css("display","none");s.after(i)}i.css("display","block"),p.isAllowed=o.isAllowed(p.cEl.el,i,i.parents("li").first())}function w(e){e.removeClass("s-l-closed").addClass("s-l-open"),e.children(o.listSelector).css("display","block");var l=e.children("div").children(".s-l-opener").first();"html"==o.opener.as?l.html(o.opener.close):"class"==o.opener.as&&l.addClass(o.opener.close).removeClass(o.opener.open)}function b(e){e.removeClass("s-l-open").addClass("s-l-closed"),e.children(o.listSelector).css("display","none");var l=e.children("div").children(".s-l-opener").first();"html"==o.opener.as?l.html(o.opener.open):"class"==o.opener.as&&l.addClass(o.opener.open).removeClass(o.opener.close)}function S(l){var s=0,t=l.children(o.listSelector);if(t.length){s++;var n=0,r=0;t.find("li").each(function(l){r=S(e(this)),n<r&&(n=r)}),n&&(s+=n)}return s}function Y(e){return o.maxLevels>p.cEl.insideLevels+function(e){for(var l=0,s=p.rootEl.el,t=e.closest(o.listSelector);!t.is(s);)l++,t=t.parent().closest(o.listSelector);return l}(p.oEl)+(e?1:0)}function L(){e(o.listSelector,p.rootEl.el).each(function(l){e(this).children().length||(e(this).prev("div").children(".s-l-opener").first().remove(),e(this).remove())})}},e.fn.sortableListsToArray=function(l,s){l=l||[];var t=0;return this.children("li").each(function(){var o=e(this),n={},r=o.attr("id");if(!r)throw console.log(o),"Previous item in console.log has no id. It is necessary to create the array.";n.id=r,n.parentId=s,n.value=o.data("value"),n.order=t,l.push(n),o.children("ul,ol").sortableListsToArray(l,r),t++}),l},e.fn.sortableListsToHierarchy=function(){var l=[],s=0;return e(this).children("li").each(function(){var t=e(this),o={},n=t.attr("id");if(!n)throw console.log(t),"Previous item in console.log has no id. It is necessary to create the array.";o.id=n,o.value=t.data("value"),o.order=s,l.push(o),o.children=t.children("ul,ol").sortableListsToHierarchy(),s++}),l},e.fn.sortableListsToString=function(l,s){return l=l||[],s=s||"no-parent",e(this).children("li").each(function(){var t=e(this),o=t.attr("id"),n=o?o.match(/(.+)[-=_](.+)/):null;if(!n)throw console.log(t),"Previous item in console.log has no id or id is not in required format xx_yy, xx-yy or xx=yy. It is necessary to create valid string.";l.push(n[1]+"["+n[2]+"]="+s),e(this).children("ul,ol").sortableListsToString(l,n[2])}),l.join("&")}}(jQuery);